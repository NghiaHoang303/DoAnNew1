{"ast":null,"code":"var _jsxFileName = \"/home/nghiahoang/DoAnNew1/frontend/src/screens/BookingScreen.js\";\nimport Axios from 'axios';\nimport { PayPalButton } from 'react-paypal-button-v2';\nimport React, { useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport { deliverBooking, detailsBooking, payBooking } from '../actions/bookingActions';\nimport LoadingBox from '../components/LoadingBox';\nimport MessageBox from '../components/MessageBox';\nimport { BOOKING_DELIVER_RESET, BOOKING_PAY_RESET } from '../constants/bookingConstants';\nexport default function BookingScreen(props) {\n  const bookingId = props.match.params.id;\n  const [sdkReady, setSdkReady] = useState(false);\n  const bookingDetails = useSelector(state => state.bookingDetails);\n  const {\n    booking,\n    loading,\n    error\n  } = bookingDetails;\n  const userSignin = useSelector(state => state.userSignin);\n  const {\n    userInfo\n  } = userSignin;\n  const bookingPay = useSelector(state => state.bookingPay);\n  const {\n    loading: loadingPay,\n    error: errorPay,\n    success: successPay\n  } = bookingPay;\n  const bookingDeliver = useSelector(state => state.bookingDeliver);\n  const {\n    loading: loadingDeliver,\n    error: errorDeliver,\n    success: successDeliver\n  } = bookingDeliver;\n  const dispatch = useDispatch();\n  useEffect(() => {\n    const addPayPalScript = async () => {\n      const {\n        data\n      } = await Axios.get('/api/config/paypal');\n      const script = document.createElement('script');\n      script.type = 'text/javascript';\n      script.src = `https://www.paypal.com/sdk/js?client-id=${data}`;\n      script.async = true;\n\n      script.onload = () => {\n        setSdkReady(true);\n      };\n\n      document.body.appendChild(script);\n    };\n\n    if (!booking || successPay || successDeliver || booking && booking._id !== bookingId) {\n      dispatch({\n        type: BOOKING_PAY_RESET\n      });\n      dispatch({\n        type: BOOKING_DELIVER_RESET\n      });\n      dispatch(detailsBooking(bookingId));\n    } else {\n      if (!booking.isPaid) {\n        if (!window.paypal) {\n          addPayPalScript();\n        } else {\n          setSdkReady(true);\n        }\n      }\n    }\n  }, [dispatch, bookingId, sdkReady, successPay, successDeliver, booking]);\n  console.log('ffff', booking);\n\n  const successPaymentHandler = paymentResult => {\n    dispatch(payBooking(booking, paymentResult));\n  };\n\n  const deliverHandler = () => {\n    dispatch(deliverBooking(booking._id));\n  };\n\n  return loading ? /*#__PURE__*/React.createElement(LoadingBox, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 5\n    }\n  }) : error ? /*#__PURE__*/React.createElement(MessageBox, {\n    variant: \"danger\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 5\n    }\n  }, error) : /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 7\n    }\n  }, \"H\\xF3a \\u0111\\u01A1n\", booking._id), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row top\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"ul\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card card-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 17\n    }\n  }, \"\\u0110\\u1EB7t tr\\u01B0\\u1EDBc\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 19\n    }\n  }, \"T\\xEAn:\"), \" \", booking.bookingTable.fullName, \" \", /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 73\n    }\n  }), /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 19\n    }\n  }, \"S\\u1ED1 \\u0111i\\u1EC7n tho\\u1EA1i: \"), \" \", booking.bookingTable.phoneNumber, \" \", /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 87\n    }\n  }), /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 19\n    }\n  }, \"Gi\\u1EDD: \"), \" \", booking.bookingTable.hour, \" \", /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 70\n    }\n  }), /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 19\n    }\n  }, \"Ng\\xE0y: \"), \" \", booking.bookingTable.date, \" \", /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 71\n    }\n  }), /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 19\n    }\n  }, \"\\u0110\\u1ECBa Ch\\u1EC9: \"), \" \", booking.bookingTable.numberPlace, \" \", /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 81\n    }\n  }), /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 19\n    }\n  }, \"M\\xF4 t\\u1EA3: \"), \" \", booking.bookingTable.description, \" \", /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 79\n    }\n  })))), /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card card-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 17\n    }\n  }, \"Thanh to\\xE1n\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 19\n    }\n  }, \"Ph\\u01B0\\u01A1ng ph\\xE1p:\"), \" \", booking.paymentMethod), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"alert\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    class: \"closebtn\",\n    onclick: \"this.parentElement.style.display='none';\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 23\n    }\n  }, \"\\xD7\"), \"Thanh to\\xE1n th\\xE0nh c\\xF4ng\"), booking.isPaid === true ? /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(MessageBox, {\n    variant: \"success\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 25\n    }\n  }, \"Thanh to\\xE1n t\\u1EA1i\", booking.paidAt)) : /*#__PURE__*/React.createElement(MessageBox, {\n    variant: \"danger\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 19\n    }\n  }, \"Ch\\u01B0a tr\\u1EA3 ti\\u1EC1n\"))), /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card card-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 17\n    }\n  }, \"\\u0110\\u1EB7t tr\\u01B0\\u1EDBc c\\xE1c m\\u1EB7t h\\xE0ng\"), /*#__PURE__*/React.createElement(\"ul\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 17\n    }\n  }, booking.bookingItems.map(item => /*#__PURE__*/React.createElement(\"li\", {\n    key: item.table,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 23\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: item.image,\n    alt: item.name,\n    className: \"small\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 27\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"min-30\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Link, {\n    to: `/table/${item.table}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 27\n    }\n  }, item.name)), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 25\n    }\n  }, item.qty, \" x $\", item.price, \" = $\", item.qty * item.price))))))))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card card-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"ul\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 17\n    }\n  }, \"\\u0110\\u1EB7t b\\xE0n Thanh to\\xE1n\")), /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 19\n    }\n  }, \"M\\u1EB7t h\\xE0ng\"), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 19\n    }\n  }, \"$\", booking.itemsPrice.toFixed(2)))), /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 19\n    }\n  }, \"Thu\\u1EBF\"), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 19\n    }\n  }, \"$\", booking.taxPrice.toFixed(2)))), /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 21\n    }\n  }, \" T\\u1ED5ng s\\u1ED1 \\u0111\\u1EB7t tr\\u01B0\\u1EDBc\")), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 21\n    }\n  }, \"$\", booking.totalPrice.toFixed(2))))), !booking.isPaid && /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 17\n    }\n  }, !sdkReady ? /*#__PURE__*/React.createElement(LoadingBox, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 21\n    }\n  }) : /*#__PURE__*/React.createElement(React.Fragment, null, errorPay && /*#__PURE__*/React.createElement(MessageBox, {\n    variant: \"danger\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 25\n    }\n  }, errorPay), loadingPay && /*#__PURE__*/React.createElement(LoadingBox, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 38\n    }\n  }), /*#__PURE__*/React.createElement(PayPalButton, {\n    amount: booking.totalPrice,\n    onSuccess: successPaymentHandler,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 23\n    }\n  }))), userInfo.isAdmin && booking.isPaid && !booking.isDelivered && /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 17\n    }\n  }, loadingDeliver && /*#__PURE__*/React.createElement(LoadingBox, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 38\n    }\n  }), errorDeliver && /*#__PURE__*/React.createElement(MessageBox, {\n    variant: \"danger\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 21\n    }\n  }, errorDeliver), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    className: \"primary block\",\n    onClick: deliverHandler,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 19\n    }\n  }, \"Cung c\\u1EA5p \\u0110\\u1EB7t ch\\u1ED7\")))))));\n}","map":{"version":3,"sources":["/home/nghiahoang/DoAnNew1/frontend/src/screens/BookingScreen.js"],"names":["Axios","PayPalButton","React","useEffect","useState","useDispatch","useSelector","Link","deliverBooking","detailsBooking","payBooking","LoadingBox","MessageBox","BOOKING_DELIVER_RESET","BOOKING_PAY_RESET","BookingScreen","props","bookingId","match","params","id","sdkReady","setSdkReady","bookingDetails","state","booking","loading","error","userSignin","userInfo","bookingPay","loadingPay","errorPay","success","successPay","bookingDeliver","loadingDeliver","errorDeliver","successDeliver","dispatch","addPayPalScript","data","get","script","document","createElement","type","src","async","onload","body","appendChild","_id","isPaid","window","paypal","console","log","successPaymentHandler","paymentResult","deliverHandler","bookingTable","fullName","phoneNumber","hour","date","numberPlace","description","paymentMethod","paidAt","bookingItems","map","item","table","image","name","qty","price","itemsPrice","toFixed","taxPrice","totalPrice","isAdmin","isDelivered"],"mappings":"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","sourcesContent":["import Axios from 'axios';\nimport { PayPalButton } from 'react-paypal-button-v2';\nimport React, { useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport { deliverBooking, detailsBooking, payBooking } from '../actions/bookingActions';\nimport LoadingBox from '../components/LoadingBox';\nimport MessageBox from '../components/MessageBox';\nimport {\n  BOOKING_DELIVER_RESET,\n  BOOKING_PAY_RESET,\n} from '../constants/bookingConstants';\n\nexport default function BookingScreen(props) {\n  const bookingId = props.match.params.id;\n  const [sdkReady, setSdkReady] = useState(false);\n  const bookingDetails = useSelector((state) => state.bookingDetails);\n  const { booking, loading, error } = bookingDetails;\n  const userSignin = useSelector((state) => state.userSignin);\n  const { userInfo } = userSignin;\n\n  const bookingPay = useSelector((state) => state.bookingPay);\n  const {\n    loading: loadingPay,\n    error: errorPay,\n    success: successPay,\n  } = bookingPay;\n  const bookingDeliver = useSelector((state) => state.bookingDeliver);\n  const {\n    loading: loadingDeliver,\n    error: errorDeliver,\n    success: successDeliver,\n  } = bookingDeliver;\n  const dispatch = useDispatch();\n  useEffect(() => {\n    const addPayPalScript = async () => {\n      const { data } = await Axios.get('/api/config/paypal');\n      const script = document.createElement('script');\n      script.type = 'text/javascript';\n      script.src = `https://www.paypal.com/sdk/js?client-id=${data}`;\n      script.async = true;\n      script.onload = () => {\n        setSdkReady(true);\n      };\n      document.body.appendChild(script);\n    };\n    if (\n      !booking ||\n      successPay ||\n      successDeliver ||\n      (booking && booking._id !== bookingId)\n    ) {\n      dispatch({ type: BOOKING_PAY_RESET });\n      dispatch({ type: BOOKING_DELIVER_RESET });\n      dispatch(detailsBooking(bookingId));\n    } else {\n      if (!booking.isPaid) {\n        if (!window.paypal) {\n          addPayPalScript();\n        } else {\n          setSdkReady(true);\n        }\n      }\n    }\n  }, [dispatch, bookingId, sdkReady, successPay, successDeliver, booking]);\n\n\n  console.log( 'ffff' ,booking)\n  const successPaymentHandler = (paymentResult) => {\n    dispatch(payBooking(booking, paymentResult));\n  };\n  const deliverHandler = () => {\n    dispatch(deliverBooking(booking._id));\n  };\n\n  return loading ? (\n    <LoadingBox></LoadingBox>\n  ) : error ? (\n    <MessageBox variant=\"danger\">{error}</MessageBox>\n  ) : (\n    <div>\n      <h1>Hóa đơn{booking._id}</h1>\n      <div className=\"row top\">\n        <div className=\"col-2\">\n          <ul>\n            <li>\n              <div className=\"card card-body\">\n                <h2>Đặt trước</h2>\n                <p>\n                  <strong>Tên:</strong> {booking.bookingTable.fullName} <br />\n                  <strong>Số điện thoại: </strong> {booking.bookingTable.phoneNumber} <br />\n                  <strong>Giờ: </strong> {booking.bookingTable.hour} <br />\n                  <strong>Ngày: </strong> {booking.bookingTable.date} <br />\n                  <strong>Địa Chỉ: </strong> {booking.bookingTable.numberPlace} <br />\n                  <strong>Mô tả: </strong> {booking.bookingTable.description} <br />\n                </p>\n              </div>\n            </li>\n            <li>\n              <div className=\"card card-body\">\n                <h2>Thanh toán</h2>\n                <p>\n                  <strong>Phương pháp:</strong> {booking.paymentMethod}\n                </p>\n                <div className = 'alert'>\n                      <span class=\"closebtn\" onclick=\"this.parentElement.style.display='none';\">&times;</span>\n                      Thanh toán thành công\n\n                      </div>\n                {booking.isPaid === true ? (\n                    <div>\n                     \n                        <MessageBox variant=\"success\">\n                          Thanh toán tại{booking.paidAt}\n                        \n                        </MessageBox>\n                    </div>\n                ) : (\n                  <MessageBox variant=\"danger\">Chưa trả tiền</MessageBox>\n                )}\n              </div>\n            </li>\n            <li>\n              <div className=\"card card-body\">\n                <h2>Đặt trước các mặt hàng</h2>\n                <ul>\n                  {booking.bookingItems.map((item) => (\n                    <li key={item.table}>\n                      <div className=\"row\">\n                        <div>\n                          <img\n                            src={item.image}\n                            alt={item.name}\n                            className=\"small\"\n                          ></img>\n                        </div>\n                        <div className=\"min-30\">\n                          <Link to={`/table/${item.table}`}>\n                            {item.name}\n                          </Link>\n                        </div>\n\n                        <div>\n                          {item.qty} x ${item.price} = ${item.qty * item.price}\n                        </div>\n                      </div>\n                    </li>\n                  ))}\n                </ul>\n              </div>\n            </li>\n          </ul>\n        </div>\n        <div className=\"col-1\">\n          <div className=\"card card-body\">\n            <ul>\n              <li>\n                <h2>Đặt bàn Thanh toán</h2>\n              </li>\n              <li>\n                <div className=\"row\">\n                  <div>Mặt hàng</div>\n                  <div>${booking.itemsPrice.toFixed(2)}</div>\n                </div>\n              </li>\n              <li>\n                <div className=\"row\">\n                  <div>Thuế</div>\n                  <div>${booking.taxPrice.toFixed(2)}</div>\n                </div>\n              </li>\n              <li>\n                <div className=\"row\">\n                  <div>\n                    <strong> Tổng số đặt trước</strong>\n                  </div>\n                  <div>\n                    <strong>${booking.totalPrice.toFixed(2)}</strong>\n                  </div>\n                </div>\n              </li>\n              {!booking.isPaid && (\n                <li>\n                  {!sdkReady ? (\n                    <LoadingBox></LoadingBox>\n                  ) : (\n                    <>\n                      {errorPay && (\n                        <MessageBox variant=\"danger\">{errorPay}</MessageBox>\n                      )}\n                      {loadingPay && <LoadingBox></LoadingBox>}\n\n                      <PayPalButton\n                        amount={booking.totalPrice}\n                        onSuccess={successPaymentHandler}\n                      ></PayPalButton>\n                    </>\n                  )}\n                </li>\n              )}\n              {userInfo.isAdmin && booking.isPaid && !booking.isDelivered && (\n                <li>\n                  {loadingDeliver && <LoadingBox></LoadingBox>}\n                  {errorDeliver && (\n                    <MessageBox variant=\"danger\">{errorDeliver}</MessageBox>\n                  )}\n                  <button\n                    type=\"button\"\n                    className=\"primary block\"\n                    onClick={deliverHandler}\n                  >\n                    Cung cấp Đặt chỗ\n                  </button>\n                </li>\n              )}\n            </ul>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}